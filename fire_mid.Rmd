---
title: "mid_analysis"
author: "Annie Kellner"
date: "2025-03-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r load-libraries}

library(tidyverse)
library(MuMIn)
library(kableExtra)

```


# DESCRIPTIVE STATS: MULTIPLE FIRES IN A DAY

*KMA*

```{r kma}

kmaFires <- read.csv("C:/Users/akellner/OneDrive - Colostate/Documents/Fire/KMA_Wx_Fire_Data/KMA_FDRS_Wildfires.csv")

kmaFires$Date <- as.Date(kmaFires$Date, format = "%m/%d/%Y")

# Find duplicates (multiple fires on a single day)

KMAdups <- kmaFires %>%
  group_by(Date) %>%
  filter(n() > 1) %>%
  arrange(Date) 

KMAdups <- KMAdups %>%
  add_count(Date) %>%
  arrange(Date) %>%
  rename(count = n)

# remove duplicate rows

KMAdups <- KMAdups %>% # reduce df to only date and count
  select(Date, count) %>%
  distinct() 

max(KMAdups$count) # maximum is 4 fires, which occurred once

fires4 <- KMAdups %>% filter(count == 4)
fires3 <- KMAdups %>% filter(count == 3)
fires2 <- KMAdups %>% filter(count == 2)

```

*PTA East*

```{r}

# Presence/Absence Fire Data

ptaE_fires <- read.csv("./Data/PTA_East/PTA_East_FDRS_Wildfires.csv")

ptaE_fires$Date <- as.Date(ptaE_fires$Date, format = "%m/%d/%Y")

# Find duplicates (multiple fires on a single day)

ptaEdups <- ptaE_fires %>%
  group_by(Date) %>%
  filter(n() > 1) %>%
  arrange(Date) 

ptaEdups <- ptaEdups %>%
  add_count(Date) %>%
  arrange(Date) %>%
  rename(count = n)

# remove duplicate rows

ptaEdups <- ptaEdups %>% # reduce df to only Date and count
  select(Date, count) %>%
  distinct() 

max(ptaEdups$count) # maximum is 4 fires, which occurred once

fires4 <- ptaEdups %>% filter(count == 4)
fires3 <- ptaEdups %>% filter(count == 3)
fires2 <- ptaEdups %>% filter(count == 2)

```


*Kipuka*

```{r}

kipFires <- read.csv("./Data/Kipuka/PTA_Southwest_FDRS_Wildfires.csv")

kipFires$Date <- as.Date(kipFires$Date, format = "%m/%d/%Y")

# Find duplicates (multiple fires on a single day)

kipDupes <- kipFires %>%
  group_by(Date) %>%
  filter(n() > 1) %>%
  arrange(Date) 

kipDupes <- kipDupes %>%
  add_count(Date) %>%
  arrange(Date) %>%
  rename(count = n)

# remove duplicate rows

kipDupes <- kipDupes %>% # reduce df to only Date and count
  select(Date, count) %>%
  distinct() 

max(kipDupes$count) # maximum is 4 fires, which occurred once

fires4 <- kipDupes %>% filter(count == 4)
fires3 <- kipDupes %>% filter(count == 3)
fires2 <- kipDupes %>% filter(count == 2)

```


*Range17*

```{r}

r17 <- read.csv("./Data/Range17/PTA_Off_Post_Fire_History.csv")

r17$Date <- as.Date(r17$Date, format = "%m/%d/%Y")

# Find duplicates (multiple fires on a single day)

r17dups <- r17 %>%
  group_by(Date) %>%
  filter(n() > 1) %>%
  arrange(Date) 

r17dups <- r17dups %>%
  add_count(Date) %>%
  arrange(Date) %>%
  rename(count = n)

# remove duplicate rows

r17dups <- r17dups %>% # reduce df to only Date and count
  select(Date, count) %>%
  distinct() 

max(r17dups$count) # maximum is 4 fires, which occurred once

fires4 <- r17dups %>% filter(count == 4)
fires3 <- r17dups %>% filter(count == 3)
fires2 <- r17dups %>% filter(count == 2)

```

# Table with data on multiple fires (will add to this table later)

```{r}

# Concatenated list of multiple fire data

multipleFires <- read_csv("./Plots_and_Tables/Multiple_Fires.csv")

knitr::kable(multipleFires,
             caption = "Days with Multiple Fires") %>%
    kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE) %>%
  row_spec(0:nrow(multipleFires),
           background = "white",
           color = "black")

```

## CREATE DATAFRAMES FOR RESPONSE VARIABLES

*KMA*

```{r}

# KMA

KMAallDates <- seq(
  from = first(kmaFires$Date),
  to = last(kmaFires$Date),
  by = "day"
)

KMAallDates <- data.frame(Date = KMAallDates) 

#KMAallDates <- KMAallDates %>% 
  #rename(Date = KMAallDates)

# Combine with presence data

kmaFires$Presence <- 1

kmaFires <- kmaFires %>%
  select(Date, Presence)

kmaComplete <- kmaFires %>% # 3659 entries
  full_join(KMAallDates) %>%
  arrange(Date) %>% 
  replace_na(list(Presence = 0)) %>%
  distinct() 

kmaComplete <- kmaComplete %>% # 3629 entries
  select(Date, Presence) %>%
  distinct()

kmaAll <- kmaComplete %>%
  left_join(KMAdups) 
  
kmaAll <- kmaAll %>%
    mutate(Count = coalesce(count, Presence)) %>%
  select(-count)

sum(kmaAll$Presence)
sum(kmaAll$Count)


```

*PTA East*

```{r}

ptaE_allDates <- seq(
  from = first(ptaE_fires$Date),
  to = last(ptaE_fires$Date),
  by = "day"
)

ptaE_allDates <- data.frame(Date = ptaE_allDates) 


# Combine with presence data

ptaE_fires$Presence <- 1

ptaE_fires <- ptaE_fires %>%
  select(Date, Presence)

ptaE_Complete <- ptaE_fires %>% 
  full_join(ptaE_allDates) %>%
  arrange(Date) %>% 
  replace_na(list(Presence = 0)) %>%
  distinct() 

ptaE_Complete <- ptaE_Complete %>% 
  select(Date, Presence) %>%
  distinct()

ptaE_All <- ptaE_Complete %>%
  left_join(ptaEdups) 
  
ptaE_All <- ptaE_All %>%
    mutate(Count = coalesce(count, Presence)) %>%
  select(-count)

sum(ptaE_All$Presence)
sum(ptaE_All$Count)

```

*Kipuka*

```{r}

kipAllDates <- seq(
  from = first(kipFires$Date),
  to = last(kipFires$Date),
  by = "day"
)

kipAllDates <- data.frame(Date = kipAllDates) 


# Combine with presence data

kipFires$Presence <- 1

kipFires <- kipFires %>%
  select(Date, Presence)

kipComplete <- kipFires %>% 
  full_join(kipAllDates) %>%
  arrange(Date) %>% 
  replace_na(list(Presence = 0)) %>%
  distinct() 

kipComplete <- kipComplete %>% 
  select(Date, Presence) %>%
  distinct()

kipAll <- kipComplete %>%
  left_join(kipDupes) 
  
kipAll <- kipAll %>%
    mutate(Count = coalesce(count, Presence)) %>%
  select(-count)

sum(kipAll$Presence)
sum(kipAll$Count)
```

*Range 17*

```{r}

r17AllDates <- seq(
  from = first(r17$Date),
  to = last(r17$Date),
  by = "day"
)

r17AllDates <- data.frame(Date = r17AllDates) 


# Combine with presence data

r17$Presence <- 1

r17Fires <- r17 %>%
  select(Date, Presence)

r17Complete <- r17Fires %>% 
  full_join(r17AllDates) %>%
  arrange(Date) %>% 
  replace_na(list(Presence = 0)) %>%
  distinct() 

r17Complete <- r17Complete %>% 
  select(Date, Presence) %>%
  distinct()

r17All <- r17Complete %>%
  left_join(r17dups) 
  
r17All <- r17All %>%
    mutate(Count = coalesce(count, Presence)) %>%
  select(-count)

sum(r17All$Presence)
sum(r17All$Count)


```


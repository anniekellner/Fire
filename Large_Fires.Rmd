---
title: "Hawaii Fire Revised Analysis"
author: "Annie Kellner"
date: "2025-04-03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
```

```{r load-libraries}

library(tidyverse)
library(kableExtra)
library(MuMIn)

```

```{r load-data}

pta <- read.csv("./Data/PTA_East/PTA_East_FDRS_Wildfires.csv")
r17 <- read.csv("./Data/Range17/PTA_Off_Post_Fire_History.csv")
kma <- read.csv("C:/Users/akellner/OneDrive - Colostate/Documents/Fire/Data/KMA_Wx_Fire_Data/KMA_FDRS_Wildfires.csv")

bigFireDays <- read_csv("./Data/Multiple_Fires.csv")

```

## Fires >= 5 Acres & >= 2 acres

```{r large-or-multiple-fires}

bigFireDays <- data.frame(
    matrix(NA, 
           nrow = 7,  # Number of metrics you want to track
           ncol = 3,  # Number of locations
           dimnames = list(
               c("Days_w_Multiple_Fires",
                 "MaxFires_OneDay",
                 "Days_2Fires",
                 "Days_3Fires",
                 "Days_4Fires",
                 "Acres5plus",
                 "Acres2plus"),  # Row names
               c("KMA", "PTA", "Range17")  # Column names
           )
    )
)



# KMA

kma5 <- kma %>%
  filter(acres >= 5) %>%
  select(Date, acres) 

bigFireDays["Acres5plus", "KMA"] <- tally(kma5)$n

kma2 <- kma %>%
  filter(acres >= 2) %>%
  select(Date, acres) 

bigFireDays["Acres2plus", "KMA"] <- tally(kma2)$n

bigFireDays["Days_w_Multiple_Fires", "KMA"] <- 29
bigFireDays["MaxFires_OneDay", "KMA"] <- 3
bigFireDays["Days_2Fires", "KMA"] <- 28
bigFireDays["Days_3Fires", "KMA"] <- 1
bigFireDays["Days_4Fires", "KMA"] <- 0


# PTA East

pta5 <- pta %>%
  filter(acres >= 5) %>%
  select(Date, acres) 

bigFireDays["Acres5plus", "PTA"] <- tally(pta5)$n

pta2 <- pta %>%
  filter(acres >= 2) %>%
  select(Date, acres) 

bigFireDays["Acres2plus", "PTA"]<- tally(pta2)$n


bigFireDays["Days_w_Multiple_Fires", "PTA"] <- 26
bigFireDays["MaxFires_OneDay", "PTA"] <- 4
bigFireDays["Days_2Fires", "PTA"] <- 18
bigFireDays["Days_3Fires", "PTA"] <- 7
bigFireDays["Days_4Fires", "PTA"] <- 1

# R17

# Range 17 looks like it comes from a different data source - could not calculate acreage

bigFireDays["Days_w_Multiple_Fires", "Range17"] <- 20
bigFireDays["MaxFires_OneDay", "Range17"] <- 4
bigFireDays["Days_2Fires", "Range17"] <- 15
bigFireDays["Days_3Fires", "Range17"] <- 4
bigFireDays["Days_4Fires", "Range17"] <- 1





knitr::kable(bigFireDays,
             caption = "Summary of Large and/or Multiple Fires") %>%
    kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE) %>%
  row_spec(0:nrow(bigFires),
           background = "white",
           color = "black")

```

## ADDING EXPLANATORY VARIABLES FROM PTA/R17 TO KMA MODELS

I added KBDI, Temp, and BI to the KMA models because those were the most important variables in PTA East and Range 17. 

# All Models with AICc < 2

```{r}

rm(list = ls()) # using dataframes with predictor and response variables

kma <- readRDS(file = "./Data/CompleteDFs/KMA_20250327.Rds")
ptaE <- readRDS(file = "./Data/CompleteDFs/ptaE_20250327.Rds")
r17 <- readRDS(file = "./Data/CompleteDFs/r17_20250327.Rds")

# Dredging

globMod <- glm(Presence ~ F100 + FM1 + KBDI + Temp + BI, data = kma, family = binomial)


options(na.action = "na.fail")

model_dredge <- dredge(globMod, 
                       evaluate = TRUE,
                       rank = "AICc")

# View top models

top_models_kma <- model.sel(model_dredge, rank = "AICc")
subset(top_models_kma, delta < 2)

```

# Model Averaging

```{r}

avg_model <- model.avg(model_dredge, subset = delta < 2)
summary(avg_model)


```

# Variable Importance

```{r}

imp <- sw(model_dredge)

var_importance_df <- data.frame(
  Variable = names(imp),
  Sum_of_Weights = imp
) %>%
  arrange(desc(Sum_of_Weights)) 

```

**FM1 is still the most predictive variable for KMA, followed by F100 (i.e., the results did not change upon adding important variables from other regions). Temp emerged in the top model set and showed a variable importance weight just below that of F100, but I'd hesitate to include it. The coefficients in the individual models as well as the model average are the inverse of what I'd expect. I added it because it was very important in the PTA first-pass results, but it wasn't originally included because the univariate analysis did not show a strong association.**

**I expected this result, but it was still worth a shot, and this gave me a little boost of confidence in the variable selection process**














